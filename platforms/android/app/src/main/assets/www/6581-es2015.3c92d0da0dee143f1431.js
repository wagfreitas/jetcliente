(self.webpackChunkdriver=self.webpackChunkdriver||[]).push([[6581],{532:function(e,t,o){"use strict";o.r(t),o.d(t,{MapPageModule:function(){return u}});var n=o(8583),a=o(3679),i=o(2859),s=o(3025),r=o(9019),c=o(7716),l=o(7152),p=o(7234),g=o(9997),d=o(5469);const h=[{path:"",component:(()=>{class e{constructor(e,t,o,n,a,i){this.router=e,this.geolocation=t,this.chRef=o,this.route=n,this.placeService=a,this.tripService=i}ngOnInit(){}ionViewDidEnter(){this.loadMap()}loadMap(){this.geolocation.getCurrentPosition().then(e=>{let t=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),o=r.NZ.mapOptions;o.center=t,o.mapTypeId=google.maps.MapTypeId.ROADMAP,this.map=new google.maps.Map(document.getElementById("map"),o),this.marker=new google.maps.Marker({map:this.map,position:t}),this.marker.setMap(this.map),this.findPlace(t),this.map.addListener("center_changed",e=>{let t=this.map.getCenter();this.findPlace(t)})}).catch(e=>{console.log("Error getting location",e)});var e=document.getElementById("searchbar");this.googleAutocomplete=new google.maps.places.Autocomplete(e),google.maps.event.addListener(this.googleAutocomplete,"place_changed",()=>{this.lat=this.googleAutocomplete.getPlace().geometry.location.lat(),this.lng=this.googleAutocomplete.getPlace().geometry.location.lng(),this.map.panTo(new google.maps.LatLng(this.lat,this.lng)),this.findPlace(new google.maps.LatLng(this.lat,this.lng))})}findPlace(e){let t=new google.maps.Geocoder;this.marker.setMap(null),this.marker=new google.maps.Marker({map:this.map,position:e}),this.marker.setMap(this.map),t.geocode({latLng:e},(e,t)=>{t==google.maps.GeocoderStatus.OK&&(this.address=e[0],console.log(this.address),this.chRef.detectChanges())})}selectPlace(){let e=this.placeService.formatAddress(this.address);console.log(e),this.route.queryParams.subscribe(t=>{let o=t.type;"origin"==o?this.tripService.setOrigin(e.vicinity,e.location.lat,e.location.lng):"destination"==o&&this.tripService.setDestination(e.vicinity,e.location.lat,e.location.lng),this.router.navigateByUrl("/home")})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(s.F0),c.Y36(l.b),c.Y36(c.sBO),c.Y36(s.gz),c.Y36(p.k),c.Y36(g.a))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-map"]],decls:15,vars:4,consts:[["color","dark"],["slot","start"],["type","text","id","searchbar","placeholder","search location or drag map","autofocus","",1,"locationinput"],["searchbar",""],["slot","end"],[3,"click"],[1,"place-text"],["id","map"],["map",""]],template:function(e,t){1&e&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar",0),c.TgZ(2,"ion-buttons",1),c._UZ(3,"ion-back-button"),c.qZA(),c._UZ(4,"input",2,3),c.TgZ(6,"ion-buttons",4),c.TgZ(7,"ion-button",5),c.NdJ("click",function(){return t.selectPlace()}),c._uU(8),c.ALo(9,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(10,"ion-content"),c.TgZ(11,"p",6),c._uU(12),c.qZA(),c._UZ(13,"div",7,8),c.qZA()),2&e&&(c.xp6(8),c.Oqu(c.lcZ(9,2,"DONE")),c.xp6(4),c.Oqu(t.address?t.address.formatted_address:""))},directives:[i.Gu,i.sr,i.Sm,i.oU,i.cs,i.YG,i.W2],pipes:[d.X$],styles:["#map[_ngcontent-%COMP%]{height:100%}.marker[_ngcontent-%COMP%]{position:fixed;z-index:1000;top:45%;left:45%}.locationinput[_ngcontent-%COMP%]{background:#eee;border:0;outline:0;width:100%;padding:.5rem;color:#333;margin:4px;font-size:14px;border-radius:4px}.place-text[_ngcontent-%COMP%]{margin:4px 0;font-size:12px;text-align:center;color:#777}"]}),e})()}];let m=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[s.Bz.forChild(h)],s.Bz]}),e})(),u=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[n.ez,a.u5,i.Pc,d.aw,m]]}),e})()}}]);