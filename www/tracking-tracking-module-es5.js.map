{"version":3,"sources":["webpack:///src/app/tracking/tracking.page.html","webpack:///src/app/tracking/tracking-routing.module.ts","webpack:///src/app/tracking/tracking.module.ts","webpack:///src/app/tracking/tracking.page.scss","webpack:///src/app/tracking/tracking.page.ts"],"names":["routes","path","component","TrackingPageRoutingModule","imports","forChild","exports","TrackingPageModule","declarations","TrackingPage","driverService","tripService","placeService","router","menuCtrl","afdb","alertCtrl","modalCtrl","ss","trip","alertCnt","rate","distanceText","durationText","settings","getSettings","subscribe","res","payload","val","enable","tripId","getId","dbRef","getTrip","valueChanges","snapshot","console","log","status","clearInterval","driverTracking","unsubscribe","navigateByUrl","skipLocationChange","replaceUrl","create","componentProps","driver","then","m","present","loadMap","latLng","google","maps","LatLng","origin","location","lat","lng","mapOptions","mapTypeId","MapTypeId","ROADMAP","center","map","Map","document","getElementById","marker","Marker","position","icon","url","size","Size","Point","anchor","scaledSize","directionsDisplay","directionsService","DirectionsService","DirectionsRenderer","polylineOptions","strokeColor","setMap","dest","destination","request","travelMode","TravelMode","DRIVING","route","response","DirectionsStatus","OK","setDirections","setInterval","getDriver","driverId","pipe","snap","showDriverOnMap","n","Array","Math","round","message","buttons","text","handler","cancelTrip","key","data","setCenter","legs","distance","duration","selector","template"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACKf,UAAMA,MAAM,GAAW,CACrB;AACEC,YAAI,EAAE,EADR;AAEEC,iBAAS,EAAE;AAFb,OADqB,CAAvB;;UAWaC,yBAAyB;AAAA;AAAA,O;;AAAzBA,+BAAyB,6DAJrC,+DAAS;AACRC,eAAO,EAAE,CAAC,6DAAaC,QAAb,CAAsBL,MAAtB,CAAD,CADD;AAERM,eAAO,EAAE,CAAC,4DAAD;AAFD,OAAT,CAIqC,GAAzBH,yBAAyB,CAAzB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCKAI,kBAAkB;AAAA;AAAA,O;;AAAlBA,wBAAkB,6DAV9B,+DAAS;AACRH,eAAO,EAAE,CACP,4DADO,EAEP,0DAFO,EAGP,0DAHO,EAIP,mEAJO,EAKP,kFALO,CADD;AAQRI,oBAAY,EAAE,CAAC,2DAAD;AARN,OAAT,CAU8B,GAAlBD,kBAAkB,CAAlB;;;;;;;;;;;;;;;;ACrBb;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCmBFE,YAAY;AAiBvB,8BACUC,aADV,EAEUC,WAFV,EAGUC,YAHV,EAIUC,MAJV,EAKUC,QALV,EAMUC,IANV,EAOUC,SAPV,EAQUC,SARV,EASUC,EATV,EAS4B;AAAA;;AAAA;;AARlB,eAAAR,aAAA,GAAAA,aAAA;AACA,eAAAC,WAAA,GAAAA,WAAA;AACA,eAAAC,YAAA,GAAAA,YAAA;AACA,eAAAC,MAAA,GAAAA,MAAA;AACA,eAAAC,QAAA,GAAAA,QAAA;AACA,eAAAC,IAAA,GAAAA,IAAA;AACA,eAAAC,SAAA,GAAAA,SAAA;AACA,eAAAC,SAAA,GAAAA,SAAA;AACA,eAAAC,EAAA,GAAAA,EAAA;AApBV,eAAAC,IAAA,GAAY,EAAZ;AAGA,eAAAC,QAAA,GAAgB,CAAhB;AACA,eAAAC,IAAA,GAAY,CAAZ;AACA,eAAAC,YAAA,GAAoB,GAApB;AACA,eAAAC,YAAA,GAAoB,GAApB;AAEA,eAAAC,QAAA,GAAgB,EAAhB;AAcE,eAAKN,EAAL,CAAQO,WAAR,GAAsBC,SAAtB,CAAgC,UAAAC,GAAG;AAAA,mBAAIA,GAAG,IAAI,IAAP,GAAc,KAAI,CAACH,QAAL,GAAgBG,GAAG,CAACC,OAAJ,CAAYC,GAAZ,EAA9B,GAAkD,KAAI,CAACL,QAAL,GAAgB,EAAtE;AAAA,WAAnC;AACD;;AA7BsB;AAAA;AAAA,qCA+BZ,CACV;AAhCsB;AAAA;AAAA,4CAmCL;AAAA;;AAChB,iBAAKV,QAAL,CAAcgB,MAAd,CAAqB,IAArB;AACA,gBAAIC,MAAM,GAAG,KAAKpB,WAAL,CAAiBqB,KAAjB,EAAb;AAEA,iBAAKC,KAAL,GAAa,KAAKtB,WAAL,CAAiBuB,OAAjB,CAAyBH,MAAzB,EAAiCI,YAAjC,GAAgDT,SAAhD,CAA0D,UAACU,QAAD,EAAmB;AACxF,kBAAIA,QAAQ,IAAI,IAAhB,EAAsB;AACpBC,uBAAO,CAACC,GAAR,CAAY,MAAI,CAACnB,IAAjB;AACA,sBAAI,CAACA,IAAL,GAAYiB,QAAZ;AAEAC,uBAAO,CAACC,GAAR,CAAY,MAAI,CAACnB,IAAjB;;AAEA,oBAAI,MAAI,CAACA,IAAL,CAAUoB,MAAV,IAAoB,sFAAxB,EAA8C;AAC5CC,+BAAa,CAAC,MAAI,CAACC,cAAN,CAAb;;AACA,wBAAI,CAACR,KAAL,CAAWS,WAAX;;AACA,wBAAI,CAAC7B,MAAL,CAAY8B,aAAZ,CAA0B,OAA1B,EAAmC;AAAEC,sCAAkB,EAAE,IAAtB;AAA4BC,8BAAU,EAAE;AAAxC,mBAAnC;AACD,iBAJD,MAKK,IAAI,MAAI,CAAC1B,IAAL,CAAUoB,MAAV,IAAoB,sFAAxB,EAA8C;AACjDC,+BAAa,CAAC,MAAI,CAACC,cAAN,CAAb;;AACA,wBAAI,CAACR,KAAL,CAAWS,WAAX;;AACA,wBAAI,CAACzB,SAAL,CAAe6B,MAAf,CAAsB;AACpB5C,6BAAS,EAAE,+DADS;AAEpB6C,kCAAc,EAAE;AACd5B,0BAAI,EAAE,MAAI,CAACA,IADG;AAEd6B,4BAAM,EAAE,MAAI,CAACA;AAFC;AAFI,mBAAtB,EAMGC,IANH,CAMQ,UAAAC,CAAC;AAAA,2BAAIA,CAAC,CAACC,OAAF,EAAJ;AAAA,mBANT;AAOD;;AAED,sBAAI,CAACC,OAAL;AACD;AACF,aA1BY,CAAb;AA4BD;AAnEsB;AAAA;AAAA,4CAqEL;AAChBf,mBAAO,CAACC,GAAR,CAAY,mBAAZ;AACAE,yBAAa,CAAC,KAAKC,cAAN,CAAb;AACA,iBAAKR,KAAL,CAAWS,WAAX;AACD;AAzEsB;AAAA;AAAA,oCA8Eb;AAAA;;AAERL,mBAAO,CAACC,GAAR,CAAY,kBAAZ;AACA,gBAAIe,MAAM,GAAG,IAAIC,MAAM,CAACC,IAAP,CAAYC,MAAhB,CAAuB,KAAKrC,IAAL,CAAUsC,MAAV,CAAiBC,QAAjB,CAA0BC,GAAjD,EAAsD,KAAKxC,IAAL,CAAUsC,MAAV,CAAiBC,QAAjB,CAA0BE,GAAhF,CAAb;AAGA,gBAAIC,UAAU,GAAQ,8EAAYA,UAAlC;AACAA,sBAAU,CAACC,SAAX,GAAuBR,MAAM,CAACC,IAAP,CAAYQ,SAAZ,CAAsBC,OAA7C;AACAH,sBAAU,CAACI,MAAX,GAAoBZ,MAApB;AAEA,iBAAKa,GAAL,GAAW,IAAIZ,MAAM,CAACC,IAAP,CAAYY,GAAhB,CAAoBC,QAAQ,CAACC,cAAT,CAAwB,KAAxB,CAApB,EAAoDR,UAApD,CAAX;AAEA,iBAAKS,MAAL,GAAc,IAAIhB,MAAM,CAACC,IAAP,CAAYgB,MAAhB,CAAuB;AACnCL,iBAAG,EAAE,KAAKA,GADyB;AAEnCM,sBAAQ,EAAEnB,MAFyB;AAGnCoB,kBAAI,EAAE;AACJC,mBAAG,EAAE,wBADD;AAEJC,oBAAI,EAAE,IAAIrB,MAAM,CAACC,IAAP,CAAYqB,IAAhB,CAAqB,EAArB,EAAyB,EAAzB,CAFF;AAGJnB,sBAAM,EAAE,IAAIH,MAAM,CAACC,IAAP,CAAYsB,KAAhB,CAAsB,CAAtB,EAAyB,CAAzB,CAHJ;AAIJC,sBAAM,EAAE,IAAIxB,MAAM,CAACC,IAAP,CAAYsB,KAAhB,CAAsB,EAAtB,EAA0B,EAA1B,CAJJ;AAKJE,0BAAU,EAAE,IAAIzB,MAAM,CAACC,IAAP,CAAYqB,IAAhB,CAAqB,EAArB,EAAyB,EAAzB;AALR;AAH6B,aAAvB,CAAd;AAYA,gBAAII,iBAAJ;AACA,gBAAIC,iBAAiB,GAAG,IAAI3B,MAAM,CAACC,IAAP,CAAY2B,iBAAhB,EAAxB;AACAF,6BAAiB,GAAG,IAAI1B,MAAM,CAACC,IAAP,CAAY4B,kBAAhB,CAAmC;AACrDC,6BAAe,EAAE;AACfC,2BAAW,EAAE;AADE;AADoC,aAAnC,CAApB;AAKAL,6BAAiB,CAACM,MAAlB,CAAyB,KAAKpB,GAA9B;AAEA,gBAAIT,MAAM,GAAG,IAAIH,MAAM,CAACC,IAAP,CAAYC,MAAhB,CAAuB,KAAKrC,IAAL,CAAUsC,MAAV,CAAiBC,QAAjB,CAA0BC,GAAjD,EAAsD,KAAKxC,IAAL,CAAUsC,MAAV,CAAiBC,QAAjB,CAA0BE,GAAhF,CAAb;AACA,gBAAI2B,IAAI,GAAG,IAAIjC,MAAM,CAACC,IAAP,CAAYC,MAAhB,CAAuB,KAAKrC,IAAL,CAAUqE,WAAV,CAAsB9B,QAAtB,CAA+BC,GAAtD,EAA2D,KAAKxC,IAAL,CAAUqE,WAAV,CAAsB9B,QAAtB,CAA+BE,GAA1F,CAAX;AAEA,gBAAI6B,OAAO,GAAG;AACZhC,oBAAM,EAAEA,MADI;AAEZ+B,yBAAW,EAAED,IAFD;AAGZG,wBAAU,EAAEpC,MAAM,CAACC,IAAP,CAAYoC,UAAZ,CAAuBC;AAHvB,aAAd;AAMAX,6BAAiB,CAACY,KAAlB,CAAwBJ,OAAxB,EAAiC,UAAUK,QAAV,EAAoBvD,MAApB,EAA4B;AAC3D,kBAAIA,MAAM,IAAIe,MAAM,CAACC,IAAP,CAAYwC,gBAAZ,CAA6BC,EAA3C,EAA+C;AAC7C3D,uBAAO,CAACC,GAAR,CAAYwD,QAAZ;AACAd,iCAAiB,CAACiB,aAAlB,CAAgCH,QAAhC;AACAd,iCAAiB,CAACM,MAAlB,CAAyB,KAAKpB,GAA9B;AACD,eAJD,MAIO;AACL7B,uBAAO,CAACC,GAAR,CAAY,OAAZ;AACD;AACF,aARD;AAUA,iBAAKG,cAAL,GAAsByD,WAAW,CAAC,YAAM;AACtC,oBAAI,CAACxF,aAAL,CAAmByF,SAAnB,CAA6B,MAAI,CAAChF,IAAL,CAAUiF,QAAvC,EAAiDjE,YAAjD,GAAgEkE,IAAhE,CAAqE,4DAAK,CAAL,CAArE,EAA8E3E,SAA9E,CAAwF,UAAA4E,IAAI,EAAI;AAC9F,sBAAI,CAACtD,MAAL,GAAcsD,IAAd;AACAjE,uBAAO,CAACC,GAAR,CAAY,MAAI,CAACU,MAAjB;;AACA,sBAAI,CAACuD,eAAL,CAAqB,MAAI,CAACvD,MAAL,CAAYW,GAAjC,EAAsC,MAAI,CAACX,MAAL,CAAYY,GAAlD;AACD,eAJD;AAKD,aANgC,EAM9B,mFAN8B,CAAjC;AAOD,WAzIsB,CA0IvB;;AA1IuB;AAAA;AAAA,gCA2IjB4C,CA3IiB,EA2Id;AACP,mBAAO,IAAIC,KAAJ,CAAUC,IAAI,CAACC,KAAL,CAAWH,CAAX,CAAV,CAAP;AACD;AA7IsB;AAAA;AAAA,uCA+IV;AAAA;;AACX,iBAAKxF,SAAL,CAAe8B,MAAf,CAAsB;AACpB8D,qBAAO,EAAE,sCADW;AAEpBC,qBAAO,EAAE,CAAC;AACRC,oBAAI,EAAE,KADE;AAERC,uBAAO,EAAE,mBAAM;AACb,wBAAI,CAACpG,WAAL,CAAiBqG,UAAjB,CAA4B,MAAI,CAAC7F,IAAL,CAAU8F,GAAtC,EAA2ChE,IAA3C,CAAgD,UAAAiE,IAAI,EAAI;AACtD7E,2BAAO,CAACC,GAAR,CAAY4E,IAAZ;AACD,mBAFD;AAGD;AANO,eAAD,EAON;AACDJ,oBAAI,EAAE;AADL,eAPM;AAFW,aAAtB,EAYG7D,IAZH,CAYQ,UAAAtB,GAAG;AAAA,qBAAIA,GAAG,CAACwB,OAAJ,EAAJ;AAAA,aAZX;AAcD,WA9JsB,CAgKvB;;AAhKuB;AAAA;AAAA,0CAiKPQ,GAjKO,EAiKFC,GAjKE,EAiKG;AAAA;;AACxB,iBAAKU,MAAL,CAAYgB,MAAZ,CAAmB,IAAnB;AACA,gBAAIjC,MAAM,GAAG,IAAIC,MAAM,CAACC,IAAP,CAAYC,MAAhB,CAAuBG,GAAvB,EAA4BC,GAA5B,CAAb;AAEA,gBAAI,KAAKzC,IAAL,CAAUoB,MAAV,IAAoB,mFAAxB,EAA2C,KAAK2B,GAAL,CAASiD,SAAT,CAAmB9D,MAAnB,EAJnB,CAMxB;;AACA,iBAAKiB,MAAL,GAAc,IAAIhB,MAAM,CAACC,IAAP,CAAYgB,MAAhB,CAAuB;AACnCL,iBAAG,EAAE,KAAKA,GADyB;AAEnCM,sBAAQ,EAAEnB,MAFyB;AAGnCoB,kBAAI,EAAE;AACJC,mBAAG,EAAE,wBADD;AAEJC,oBAAI,EAAE,IAAIrB,MAAM,CAACC,IAAP,CAAYqB,IAAhB,CAAqB,EAArB,EAAyB,EAAzB,CAFF;AAGJnB,sBAAM,EAAE,IAAIH,MAAM,CAACC,IAAP,CAAYsB,KAAhB,CAAsB,CAAtB,EAAyB,CAAzB,CAHJ;AAIJC,sBAAM,EAAE,IAAIxB,MAAM,CAACC,IAAP,CAAYsB,KAAhB,CAAsB,EAAtB,EAA0B,EAA1B,CAJJ;AAKJE,0BAAU,EAAE,IAAIzB,MAAM,CAACC,IAAP,CAAYqB,IAAhB,CAAqB,EAArB,EAAyB,EAAzB;AALR;AAH6B,aAAvB,CAAd;AAaA,gBAAIK,iBAAiB,GAAG,IAAI3B,MAAM,CAACC,IAAP,CAAY2B,iBAAhB,EAAxB;AACA,gBAAIO,OAAO,GAAQ,EAAnB;;AAEA,gBAAI,KAAKtE,IAAL,CAAUoB,MAAV,IAAoB,SAAxB,EAAmC;AACjCkD,qBAAO,GAAG;AACRhC,sBAAM,EAAEJ,MADA;AAERmC,2BAAW,EAAE,IAAIlC,MAAM,CAACC,IAAP,CAAYC,MAAhB,CAAuB,KAAKrC,IAAL,CAAUsC,MAAV,CAAiBC,QAAjB,CAA0BC,GAAjD,EAAsD,KAAKxC,IAAL,CAAUsC,MAAV,CAAiBC,QAAjB,CAA0BE,GAAhF,CAFL;AAGR8B,0BAAU,EAAEpC,MAAM,CAACC,IAAP,CAAYoC,UAAZ,CAAuBC;AAH3B,eAAV;AAKD,aAND,MAQK;AACHH,qBAAO,GAAG;AACRhC,sBAAM,EAAEJ,MADA;AAERmC,2BAAW,EAAE,IAAIlC,MAAM,CAACC,IAAP,CAAYC,MAAhB,CAAuB,KAAKrC,IAAL,CAAUqE,WAAV,CAAsB9B,QAAtB,CAA+BC,GAAtD,EAA2D,KAAKxC,IAAL,CAAUqE,WAAV,CAAsB9B,QAAtB,CAA+BE,GAA1F,CAFL;AAGR8B,0BAAU,EAAEpC,MAAM,CAACC,IAAP,CAAYoC,UAAZ,CAAuBC;AAH3B,eAAV;AAKD;;AAEDX,6BAAiB,CAACY,KAAlB,CAAwBJ,OAAxB,EAAiC,UAACK,QAAD,EAAWvD,MAAX,EAAsB;AACrD,kBAAIA,MAAM,IAAIe,MAAM,CAACC,IAAP,CAAYwC,gBAAZ,CAA6BC,EAA3C,EAA+C;AAC7C3D,uBAAO,CAACC,GAAR,CAAYwD,QAAZ;AACA,sBAAI,CAACxE,YAAL,GAAoBwE,QAAQ,CAAC9F,MAAT,CAAgB,CAAhB,EAAmBoH,IAAnB,CAAwB,CAAxB,EAA2BC,QAA3B,CAAoCP,IAAxD;AACA,sBAAI,CAACvF,YAAL,GAAoBuE,QAAQ,CAAC9F,MAAT,CAAgB,CAAhB,EAAmBoH,IAAnB,CAAwB,CAAxB,EAA2BE,QAA3B,CAAoCR,IAAxD;AACD,eAJD,MAIO;AACLzE,uBAAO,CAACC,GAAR,CAAY,OAAZ;AACD;AACF,aARD;AASD;AAjNsB;;AAAA;AAAA,S;;;;gBAjBhB;;gBAEA;;gBACA;;gBAEA;;gBAJA;;gBAKA;;gBALgB;;gBAAiB;;gBAOjC;;;;AASI7B,kBAAY,6DALxB,gEAAU;AACT8G,gBAAQ,EAAE,cADD;AAETC,gBAAQ,EAAR;AAAA;AAAA,kGAFS;;;;AAAA,OAAV,CAKwB,GAAZ/G,YAAY,CAAZ","file":"tracking-tracking-module-es5.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"dark\\\">\\n    <ion-title>{{'ON_THE_WAY' | translate}}</ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button color=\\\"danger\\\" fill=\\\"solid\\\" size=\\\"small\\\" *ngIf=\\\"trip.status == 'waiting'\\\" (click)=\\\"cancelTrip()\\\">\\n        {{'CANCEL_TRIP' | translate}}\\n      </ion-button>\\n      <ion-button fill=\\\"solid\\\" color=\\\"danger\\\" href=\\\"tel:{{settings.sos}}\\\" *ngIf=\\\"trip.status == 'going'\\\">{{'SOS' |\\n        translate}}\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <div id=\\\"map\\\" style=\\\"height:100%\\\"></div>\\n  <ion-card>\\n    <div style=\\\"text-align:right; color: #222\\\">\\n      <span style=\\\"background:#ffff00\\\">{{ 'OTP' | translate}}: {{ (trip)?.otp }}</span>\\n    </div>\\n    <ion-item lines=\\\"none\\\">\\n      <ion-avatar slot=\\\"start\\\">\\n        <img src=\\\"{{ (driver)?.photoURL }}\\\" onerror=\\\"this.src='./assets/img/default.png'\\\" />\\n      </ion-avatar>\\n      <ion-label>\\n        <ion-text>\\n          <h2>{{ (driver)?.name }} &nbsp; {{(driver)?.rating}} <ion-icon name=\\\"star\\\" color=\\\"yellow\\\"></ion-icon>\\n          </h2>\\n        </ion-text>\\n        <ion-text>\\n          <p>{{ (driver)?.plate }} &middot; {{ (driver)?.brand }}</p>\\n        </ion-text>\\n      </ion-label>\\n      <ion-button color=\\\"dark\\\" slot=\\\"end\\\" href=\\\"tel: {{ (driver)?.phoneNumber }} \\\">\\n        <ion-icon name=\\\"call\\\"></ion-icon>&nbsp;{{'CALL' | translate}}\\n      </ion-button>\\n    </ion-item>\\n    <ion-row>\\n      <ion-col>\\n        <p>{{'DISTANCE' | translate}}</p>\\n        <h5>{{distanceText}}</h5>\\n      </ion-col>\\n      <ion-col>\\n        <p>{{'ETA' | translate}}</p>\\n        <h5>{{durationText}}</h5>\\n      </ion-col>\\n      <ion-col>\\n        <p>{{'PRICE' | translate}}</p>\\n        <h5>{{ trip.currency }} {{trip.fee}}</h5>\\n      </ion-col>\\n      <ion-col>\\n        <p>{{'PAYMENT' | translate}}</p>\\n        <h5>{{trip.paymentMethod}}</h5>\\n      </ion-col>\\n    </ion-row>\\n  </ion-card>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { TrackingPage } from './tracking.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: TrackingPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class TrackingPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { TrackingPageRoutingModule } from './tracking-routing.module';\n\nimport { TrackingPage } from './tracking.page';\nimport { TranslateModule } from '@ngx-translate/core';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    TranslateModule,\n    TrackingPageRoutingModule\n  ],\n  declarations: [TrackingPage]\n})\nexport class TrackingPageModule {}\n","export default \"ion-col p, h5 {\\n  margin: 0;\\n  text-align: center;\\n}\\n\\nion-col h5 {\\n  font-size: 16px;\\n  color: #333;\\n}\\n\\nion-card {\\n  position: absolute;\\n  z-index: 999999;\\n  background: #fff;\\n  bottom: 0;\\n  left: 0;\\n  right: 0;\\n  padding: 8px;\\n}\\n\\n.footer-md:before {\\n  background-image: none !important;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdHJhY2tpbmcvdHJhY2tpbmcucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksU0FBQTtFQUNBLGtCQUFBO0FBQ0o7O0FBQ0E7RUFDSSxlQUFBO0VBQ0EsV0FBQTtBQUVKOztBQUNBO0VBQ0ksa0JBQUE7RUFDQSxlQUFBO0VBQ0EsZ0JBQUE7RUFDQSxTQUFBO0VBQ0EsT0FBQTtFQUNBLFFBQUE7RUFDQSxZQUFBO0FBRUo7O0FBQ0E7RUFDSSxpQ0FBQTtBQUVKIiwiZmlsZSI6InNyYy9hcHAvdHJhY2tpbmcvdHJhY2tpbmcucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLWNvbCBwLCBoNXtcbiAgICBtYXJnaW46MDtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG5pb24tY29sIGg1e1xuICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICBjb2xvcjogIzMzMztcbn1cblxuaW9uLWNhcmR7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHotaW5kZXg6IDk5OTk5OTtcbiAgICBiYWNrZ3JvdW5kOiAjZmZmO1xuICAgIGJvdHRvbTogMDtcbiAgICBsZWZ0OiAwO1xuICAgIHJpZ2h0OiAwO1xuICAgIHBhZGRpbmc6IDhweDtcbn1cblxuLmZvb3Rlci1tZDpiZWZvcmV7XG4gICAgYmFja2dyb3VuZC1pbWFnZTogbm9uZSAhaW1wb3J0YW50O1xufSJdfQ== */\";","import { Component, OnInit } from '@angular/core';\nimport { POSITION_INTERVAL, TRIP_STATUS_GOING, TRIP_STATUS_CANCELED, TRIP_STATUS_FINISHED, environment } from 'src/environments/environment.prod';\nimport { DriverService } from '../services/driver.service';\nimport { MenuController, AlertController, ModalController } from '@ionic/angular';\nimport { TripService } from '../services/trip.service';\nimport { PlaceService } from '../services/place.service';\nimport { take } from 'rxjs/operators';\nimport { Router } from '@angular/router';\nimport { AngularFireDatabase } from '@angular/fire/database';\nimport { RatingPage } from '../rating/rating.page';\nimport { SettingService } from '../services/setting.service';\n\ndeclare var google: any;\n\n@Component({\n  selector: 'app-tracking',\n  templateUrl: './tracking.page.html',\n  styleUrls: ['./tracking.page.scss'],\n})\nexport class TrackingPage implements OnInit {\n\n\n\n  driver: any;\n  map: any;\n  trip: any = {};\n  driverTracking: any;\n  marker: any;\n  alertCnt: any = 0;\n  rate: any = 5;\n  distanceText: any = \"-\";\n  durationText: any = \"-\";\n  ref: any;\n  settings: any = {};\n  dbRef: any;\n\n  constructor(\n    private driverService: DriverService,\n    private tripService: TripService,\n    private placeService: PlaceService,\n    private router: Router,\n    private menuCtrl: MenuController,\n    private afdb: AngularFireDatabase,\n    private alertCtrl: AlertController,\n    private modalCtrl: ModalController,\n    private ss: SettingService\n  ) {\n    this.ss.getSettings().subscribe(res => res != null ? this.settings = res.payload.val() : this.settings = {});\n  }\n\n  ngOnInit() {\n  }\n\n\n  ionViewDidEnter() {\n    this.menuCtrl.enable(true);\n    let tripId = this.tripService.getId();\n\n    this.dbRef = this.tripService.getTrip(tripId).valueChanges().subscribe((snapshot: any) => {\n      if (snapshot != null) {\n        console.log(this.trip)\n        this.trip = snapshot;\n\n        console.log(this.trip);\n\n        if (this.trip.status == TRIP_STATUS_CANCELED) {\n          clearInterval(this.driverTracking);\n          this.dbRef.unsubscribe();\n          this.router.navigateByUrl('/home', { skipLocationChange: true, replaceUrl: true });\n        }\n        else if (this.trip.status == TRIP_STATUS_FINISHED) {\n          clearInterval(this.driverTracking);\n          this.dbRef.unsubscribe();\n          this.modalCtrl.create({\n            component: RatingPage,\n            componentProps: {\n              trip: this.trip,\n              driver: this.driver\n            }\n          }).then(m => m.present());\n        }\n\n        this.loadMap();\n      }\n    });\n\n  }\n\n  ionViewDidLeave() {\n    console.log(\"ionViewDidLeave()\");\n    clearInterval(this.driverTracking);\n    this.dbRef.unsubscribe();\n  }\n\n\n\n\n  loadMap() {\n\n    console.log(\"load Map calling\");\n    let latLng = new google.maps.LatLng(this.trip.origin.location.lat, this.trip.origin.location.lng);\n\n\n    let mapOptions: any = environment.mapOptions;\n    mapOptions.mapTypeId = google.maps.MapTypeId.ROADMAP;\n    mapOptions.center = latLng;\n\n    this.map = new google.maps.Map(document.getElementById(\"map\"), mapOptions);\n\n    this.marker = new google.maps.Marker({\n      map: this.map,\n      position: latLng,\n      icon: {\n        url: 'assets/img/map-suv.png',\n        size: new google.maps.Size(32, 32),\n        origin: new google.maps.Point(0, 0),\n        anchor: new google.maps.Point(16, 16),\n        scaledSize: new google.maps.Size(32, 32)\n      },\n    });\n\n    let directionsDisplay;\n    let directionsService = new google.maps.DirectionsService();\n    directionsDisplay = new google.maps.DirectionsRenderer({\n      polylineOptions: {\n        strokeColor: \"black\"\n      }\n    });\n    directionsDisplay.setMap(this.map);\n\n    let origin = new google.maps.LatLng(this.trip.origin.location.lat, this.trip.origin.location.lng);\n    let dest = new google.maps.LatLng(this.trip.destination.location.lat, this.trip.destination.location.lng);\n\n    var request = {\n      origin: origin,\n      destination: dest,\n      travelMode: google.maps.TravelMode.DRIVING\n    };\n\n    directionsService.route(request, function (response, status) {\n      if (status == google.maps.DirectionsStatus.OK) {\n        console.log(response);\n        directionsDisplay.setDirections(response);\n        directionsDisplay.setMap(this.map);\n      } else {\n        console.log(\"error\");\n      }\n    });\n\n    this.driverTracking = setInterval(() => {\n      this.driverService.getDriver(this.trip.driverId).valueChanges().pipe(take(1)).subscribe(snap => {\n        this.driver = snap;\n        console.log(this.driver);\n        this.showDriverOnMap(this.driver.lat, this.driver.lng);\n      });\n    }, POSITION_INTERVAL);\n  }\n  // make array with range is n\n  range(n) {\n    return new Array(Math.round(n));\n  }\n\n  cancelTrip() {\n    this.alertCtrl.create({\n      message: \"Are you sure want to cancel the trip\",\n      buttons: [{\n        text: \"Yes\",\n        handler: () => {\n          this.tripService.cancelTrip(this.trip.key).then(data => {\n            console.log(data);\n          })\n        }\n      }, {\n        text: \"No\"\n      }]\n    }).then(res => res.present());\n\n  }\n\n  // show user on map\n  showDriverOnMap(lat, lng) {\n    this.marker.setMap(null);\n    let latLng = new google.maps.LatLng(lat, lng);\n\n    if (this.trip.status == TRIP_STATUS_GOING) this.map.setCenter(latLng);\n\n    // show vehicle to map\n    this.marker = new google.maps.Marker({\n      map: this.map,\n      position: latLng,\n      icon: {\n        url: 'assets/img/map-suv.png',\n        size: new google.maps.Size(32, 32),\n        origin: new google.maps.Point(0, 0),\n        anchor: new google.maps.Point(16, 16),\n        scaledSize: new google.maps.Size(32, 32)\n      },\n    });\n\n\n    let directionsService = new google.maps.DirectionsService();\n    let request: any = {};\n\n    if (this.trip.status == 'waiting') {\n      request = {\n        origin: latLng,\n        destination: new google.maps.LatLng(this.trip.origin.location.lat, this.trip.origin.location.lng),\n        travelMode: google.maps.TravelMode.DRIVING\n      }\n    }\n\n    else {\n      request = {\n        origin: latLng,\n        destination: new google.maps.LatLng(this.trip.destination.location.lat, this.trip.destination.location.lng),\n        travelMode: google.maps.TravelMode.DRIVING\n      }\n    }\n\n    directionsService.route(request, (response, status) => {\n      if (status == google.maps.DirectionsStatus.OK) {\n        console.log(response);\n        this.distanceText = response.routes[0].legs[0].distance.text;\n        this.durationText = response.routes[0].legs[0].duration.text;\n      } else {\n        console.log(\"error\");\n      }\n    });\n  }\n}\n"]}